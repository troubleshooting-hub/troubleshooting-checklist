<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <base href="/troubleshooting-checklist/">

  <title>Troubleshooting Checklist Portal</title>

  <link rel="stylesheet" href="style.css?v=32" />
</head>

<body>

<!-- ======================================================
     AUTH GATE (Login Page – Shows First)
====================================================== -->
<div id="authGate" class="auth-gate">
  <div class="auth-card">

    <div class="auth-brand">
      <img class="auth-logo" src="assets/aquera-logo.png" alt="Aquera" />
      <div>
        <div class="auth-title">Troubleshooting Checklist Portal</div>
        <div class="auth-sub">Sign in to continue</div>
      </div>
    </div>

    <div id="authError" class="auth-error hidden"></div>

    <button id="googleSignInBtn" type="button" class="btn btn-primary auth-btn">
      Continue with Google
    </button>

    <div class="auth-divider"><span>or</span></div>

    <label class="auth-label">Email</label>
    <input id="authEmail" class="auth-input" type="email" placeholder="name@example.com" />

    <label class="auth-label">Password</label>
    <input id="authPassword" class="auth-input" type="password" placeholder="Password" />

    <div class="auth-actions">
      <button id="emailSignInBtn" type="button" class="btn btn-secondary auth-btn">
        Sign in
      </button>
      <button id="emailRegisterBtn" type="button" class="btn btn-secondary auth-btn">
        Register
      </button>
    </div>

    <div class="auth-meta">
      Internal use only
    </div>

  </div>
</div>

<!-- ======================================================
     MAIN APPLICATION (Hidden Until Authenticated)
====================================================== -->
<div id="appRoot" class="hidden">

<header class="site-header">
  <div class="header-inner header-flex">
    <img class="brand-logo" src="assets/aquera-logo.png" alt="Aquera" />

    <div class="header-text">
      <h1>Troubleshooting Checklist Portal</h1>
      <p>Internal Support & Investigation Guide</p>
    </div>

    <button id="themeToggle" class="theme-toggle" type="button">
      ☀️
    </button>
  </div>
</header>

<main class="page">

  <!-- =======================
       YOUR EXISTING PORTAL UI
       (UNCHANGED)
  ======================== -->

  <!-- KEEP ALL YOUR EXISTING SECTIONS EXACTLY AS THEY WERE -->
  <!-- Common, Bin, New Issues, Help Sections remain unchanged -->

</main>

<footer class="site-footer">
  Internal Use Only | Troubleshooting Portal
</footer>

</div> <!-- End appRoot -->

<!-- ======================================================
     Firebase Setup (App + Firestore + Auth)
====================================================== -->
<script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    doc,
    updateDoc,
    deleteDoc,
    serverTimestamp,
    query,
    orderBy
  } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

  import {
    getAuth,
    GoogleAuthProvider,
    signInWithPopup,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC7hu52JLlf9_IA0UA10RaIRiWaoWhIpr8",
    authDomain: "troubleshooting-hub.firebaseapp.com",
    projectId: "troubleshooting-hub",
    storageBucket: "troubleshooting-hub.firebasestorage.app",
    messagingSenderId: "725774852364",
    appId: "1:725774852364:web:5c16dcaffa96a5b7ab6929"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  window.db = db;
  window.auth = auth;

  window.firebaseFns = {
    collection,
    addDoc,
    getDocs,
    doc,
    updateDoc,
    deleteDoc,
    serverTimestamp,
    query,
    orderBy
  };

  window.firebaseAuth = {
    GoogleAuthProvider,
    signInWithPopup,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  };

  const s = document.createElement("script");
  s.src = "/troubleshooting-checklist/script.js?v=32";
  s.defer = true;
  document.body.appendChild(s);

</script>

</body>
</html>